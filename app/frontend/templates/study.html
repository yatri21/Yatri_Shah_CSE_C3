{% extends "base.html" %}

{% block title %}Study Session - Study Buddy{% endblock %}

{% block content %}
<div class="study-container">
    <div class="study-header">
        <h1><i class="fas fa-book-open"></i> Study Session</h1>
        <div class="session-info">
            <div class="timer-container">
                <div class="timer-display">
                    <i class="fas fa-clock"></i>
                    <span id="timerDisplay">00:00</span>
                </div>
                <div class="timer-controls">
                    <button class="btn-timer" onclick="toggleTimer()" id="timerBtn">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="btn-timer" onclick="resetTimer()">
                        <i class="fas fa-redo"></i>
                    </button>
                </div>
            </div>
            <div class="progress-container">
                <div class="circular-progress" id="circularProgress">
                    <svg class="progress-ring" width="80" height="80">
                        <circle class="progress-ring-circle" stroke="#e6e6e6" stroke-width="6" fill="transparent" r="34" cx="40" cy="40"/>
                        <circle class="progress-ring-fill" stroke="#4CAF50" stroke-width="6" fill="transparent" r="34" cx="40" cy="40" id="progressCircle"/>
                    </svg>
                    <div class="progress-percentage" id="progressPercentage">0%</div>
                </div>
                <span class="progress-text" id="progressText">0% Complete</span>
            </div>
        </div>
    </div>

    <div class="study-card" id="studyCard">
        <div class="card-content">
            <div class="question-side" id="questionSide">
                <div class="card-type">
                    <i class="fas fa-question-circle"></i> Question
                </div>
                <div class="card-text" id="questionText">Loading your study session...</div>
                <button class="btn btn-primary btn-large" onclick="showAnswer()">
                    <i class="fas fa-eye"></i> Show Answer
                </button>
            </div>
            
            <div class="answer-side" id="answerSide" style="display: none;">
                <div class="card-type">
                    <i class="fas fa-lightbulb"></i> Answer
                </div>
                <div class="card-text" id="answerText"></div>
                <div class="answer-buttons">
                    <button class="btn btn-success" onclick="markCorrect()">
                        <i class="fas fa-check"></i> Got it!
                    </button>
                    <button class="btn btn-warning" onclick="markIncorrect()">
                        <i class="fas fa-times"></i> Need practice
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="study-controls">
        <button class="btn btn-secondary" onclick="previousCard()" id="prevBtn">
            <i class="fas fa-chevron-left"></i> Previous
        </button>
        
        <div class="card-counter">
            <span id="cardCounter">1 / 4</span>
        </div>
        
        <button class="btn btn-secondary" onclick="nextCard()" id="nextBtn">
            Next <i class="fas fa-chevron-right"></i>
        </button>
    </div>

    <div class="study-modes">
        <button class="btn btn-accent" onclick="startQuiz()">
            <i class="fas fa-random"></i> Quiz Mode
        </button>
        <button class="btn btn-info" onclick="resetSession()">
            <i class="fas fa-redo"></i> Reset Session
        </button>
        <a href="{{ url_for('dashboard') }}" class="btn btn-outline">
            <i class="fas fa-home"></i> Back to Dashboard
        </a>
    </div>

    <div class="study-stats">
        <div class="stat-item">
            <i class="fas fa-check-circle"></i>
            <span>Correct: <strong id="correctCount">0</strong></span>
        </div>
        <div class="stat-item">
            <i class="fas fa-times-circle"></i>
            <span>Incorrect: <strong id="incorrectCount">0</strong></span>
        </div>
        <div class="stat-item">
            <i class="fas fa-percentage"></i>
            <span>Accuracy: <strong id="accuracyRate">0%</strong></span>
        </div>
        <div class="stat-item">
            <i class="fas fa-stopwatch"></i>
            <span>Time: <strong id="totalTime">00:00</strong></span>
        </div>
    </div>

    <div class="progress-charts">
        <div class="chart-container">
            <h3><i class="fas fa-chart-pie"></i> Session Progress</h3>
            <canvas id="progressChart" width="300" height="200"></canvas>
        </div>
        <div class="chart-container">
            <h3><i class="fas fa-chart-bar"></i> Performance Trend</h3>
            <canvas id="performanceChart" width="300" height="200"></canvas>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/study.js') }}"></script>
{% endblock %}